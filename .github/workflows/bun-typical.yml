name: Bun Typical

on:
  workflow_call:
    inputs:
      bun-version:
        type: string
        description: 'The version of Bun to download and install.'
        required: false
        default: latest
      timeout-minutes:
        type: number
        description: 'Timeout in minutes for the workflow run. Defaults to 30.'
        required: false
        default: 30

jobs:
  build:
    name: Lint, format, test and build
    runs-on: ubuntu-latest
    timeout-minutes: ${{ inputs.timeout-minutes }}

    steps:
      - name: Checkout ğŸ›ï¸
        uses: actions/checkout@v3

      - name: Setup pnpm ğŸ“¦ï¸
        uses: oven-sh/setup-bun@v1
        with:
          bun-version: ${{ inputs.bun-version }}

      - name: Install dependencies ğŸ“¦ï¸
        run: bun install --frozen-lockfile

      - name: Build ğŸ”¨
        run: bun run build

      - name: Lint ğŸ”
        run: bun run lint

      - name: Format ğŸ–Œï¸
        run: bun run format

      - name: Test ğŸ§ª
        run: bun run test
